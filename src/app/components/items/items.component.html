<div class="sky-card">
  <div class="sky-card-header">
    <h1 class="h2 mb-0">Items</h1>
  </div>
</div>

<!-- Categories -->
<div class="sky-card mt">
  <div class="sky-card-header">
    <h2 class="h3 mb-0">Type</h2>
  </div>
  <div class="sky-card-body">
    <div class="flex">
      <!-- Outfits -->
      <div class="item-icon category" [class.highlight]="type === 'Outfit'"
      [ngbTooltip]="'Outfits'" container="body" placement="bottom"
        (click)="selectCategory('Outfit')">
        <mat-icon svgIcon="outfit"></mat-icon>
      </div>
      <!-- Shoes -->
      <div class="item-icon category" [class.highlight]="type === 'Shoes'"
      [ngbTooltip]="'Shoes'" container="body" placement="bottom"
        (click)="selectCategory('Shoes')">
        <mat-icon svgIcon="shoes"></mat-icon>
      </div>
      <!-- Masks -->
      <div class="item-icon category" [class.highlight]="type === 'Mask'"
      [ngbTooltip]="'Masks'" container="body" placement="bottom"
        (click)="selectCategory('Mask')">
        <mat-icon svgIcon="mask"></mat-icon>
      </div>
      <!-- Face Accessories -->
      <div class="item-icon category" [class.highlight]="type === 'FaceAccessory'"
      [ngbTooltip]="'Face accessories'" container="body" placement="bottom"
        (click)="selectCategory('FaceAccessory')">
        <mat-icon svgIcon="face-acc"></mat-icon>
      </div>
      <!-- Necklaces -->
      <div class="item-icon category" [class.highlight]="type === 'Necklace'"
      [ngbTooltip]="'Necklaces'" container="body" placement="bottom"
        (click)="selectCategory('Necklace')">
        <mat-icon svgIcon="necklace"></mat-icon>
      </div>
      <!-- Hair -->
      <div class="item-icon category" [class.highlight]="type === 'Hair'"
      [ngbTooltip]="'Hair'" container="body" placement="bottom"
        (click)="selectCategory('Hair')">
        <mat-icon svgIcon="hair"></mat-icon>
      </div>
      <!-- Hats -->
      <div class="item-icon category" [class.highlight]="type === 'Hat'"
      [ngbTooltip]="'Hats'" container="body" placement="bottom"
        (click)="selectCategory('Hat')">
        <mat-icon svgIcon="hat"></mat-icon>
      </div>
      <!-- Capes -->
      <div class="item-icon category" [class.highlight]="type === 'Cape'"
      [ngbTooltip]="'Capes'" container="body" placement="bottom"
        (click)="selectCategory('Cape')">
        <mat-icon svgIcon="cape"></mat-icon>
      </div>
      <!-- Held -->
      <div class="item-icon category" [class.highlight]="type === 'Held'"
      [ngbTooltip]="'Held props'" container="body" placement="bottom"
        (click)="selectCategory('Held')">
        <mat-icon svgIcon="held"></mat-icon>
      </div>
      <!-- Prop -->
      <div class="item-icon category" [class.highlight]="type === 'Prop'"
      [ngbTooltip]="'Props'" container="body" placement="bottom"
        (click)="selectCategory('Prop')">
        <mat-icon svgIcon="prop"></mat-icon>
      </div>
      <!-- Emote -->
      <div class="item-icon category" [class.highlight]="type === 'Emote'"
      [ngbTooltip]="'Emotes'" container="body" placement="bottom"
        (click)="selectCategory('Emote')">
        <mat-icon svgIcon="emote"></mat-icon>
      </div>
      <!-- Stance -->
      <div class="item-icon category" [class.highlight]="type === 'Stance'"
      [ngbTooltip]="'Stances'" container="body" placement="bottom"
        (click)="selectCategory('Stance')">
        <mat-icon svgIcon="stance"></mat-icon>
      </div>
      <!-- Call -->
      <div class="item-icon category" [class.highlight]="type === 'Call'"
      [ngbTooltip]="'Calls'" container="body" placement="bottom"
        (click)="selectCategory('Call')">
        <mat-icon svgIcon="call"></mat-icon>
      </div>
    </div>
  </div>
</div>

<!-- Items -->
<div class="sky-card mt" *ngIf="shownItems?.length">
  <div class="sky-card-header">
    <div class="unlock-bar">
      You have unlocked
      <b [class.completed]="shownUnlocked == shownItems.length">{{ shownUnlocked }}</b>
      out of
      <b [class.completed]="shownUnlocked == shownItems.length">{{ shownItems.length }}</b>
      items.
      <div class="column-toggle">
        <mat-icon (click)="setColumns()" [ngbTooltip]="'Toggle column size'" container="body" placement="left">apps</mat-icon>
      </div>
    </div>
  </div>

  <div class="sky-card-body">
    <div class="flex item-grid" [class.gap-half-y]="columns">
      <div class="item-icon" *ngIf="showNone && columns">
        <div class="item-none">
          <mat-icon class="" svgIcon="none"></mat-icon>
        </div>
      </div>
      <ng-container *ngFor="let item of shownItems; let i = index">
        <div class="item-col-hr" [style.display]="!columns || !i || ((i+offsetNone) % columns) ? undefined : 'block'"></div>
        <div class="item-icon">
          <app-item [item]="item" [showSubIcons]="true" class="a"
            (click)="selectItem($event, item)"
            [class.highlight]="item && item === selectedItem"
            [class.item-unlocked]="item.unlocked && (item.type !== typeEmote || item.level! >= emoteLevels[item.name])"
            [ngbTooltip]="item.name" container="body" placement="auto" >
          </app-item>
          <mat-icon class="unlock-check" [class.self]="item.type !== typeEmote || item.level! >= emoteLevels[item.name]" [class.unlocked]="item.unlocked">done</mat-icon>
        </div>
      </ng-container>
    </div>
  </div>
</div>

<!-- Selected item -->
<div #itemDiv [hidden]="!selectedItem" class="grid grid-1 item-info mt">
  <div class="sky-card" *ngIf="selectedItem">
    <div class="sky-card-header">
      <h2 class="h3">{{ selectedItem.name }}</h2>
    </div>
    <div class="sky-card-body">
      <div class="info-grid">
        <a class="item-icon item-icon-large info-grid-icon d-inline-block" [routerLink]="selectedItemNav?.route" [queryParams]="selectedItemNav?.extras?.queryParams">
          <app-item [item]="selectedItem" [large]="true" [highlight]="true" [hoverHighlight]="false"></app-item>
        </a>
        <app-wiki-link [wiki]="selectedItem._wiki" [aClass]="'info-grid-find container'"></app-wiki-link>
        <a *ngIf="selectedItemNav" class="info-grid-find container" [routerLink]="selectedItemNav.route" [queryParams]="selectedItemNav.extras?.queryParams">
          <mat-icon class="menu-icon">search</mat-icon>
          <span class="menu-label">Find item</span>
        </a>
        <div *ngIf="selectedItem.type === 'Call'" class="container action us-none" appCall [item]="selectedItem">
          <mat-icon class="menu-icon">volume_up</mat-icon>
          <span class="menu-label">Play sound</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Field guide -->
<ng-container *ngIf="previewItems?.length">
  <div class="sky-card mt">
    <div class="sky-card-header header-previews" (click)="togglePreviews()">
      <h2 class="h3 mb-0">
        Field guide
        <mat-icon>{{showFieldGuide ? 'keyboard_arrow_up' : 'keyboard_arrow_down' }}</mat-icon>
      </h2>
    </div>
    <div class="sky-card-body" *ngIf="showFieldGuide">
      <div class="sky-flex flex-wrap" *ngIf="previewItems?.length">
        <ng-container *ngFor="let item of previewItems">
          <div *ngIf="item.previewUrl" (click)="openItem(item)"
          [class.highlight]="item && item === selectedItem"
            class="item-preview link" [ngbTooltip]="item.name" container="body" placement="auto">
            <div class="pad">
              <div class="item-preview-icon">
                <app-item [item]="item" [hoverHighlight]="false" [highlight]="true" [showSubIcons]="false"></app-item>
              </div>
              <div class="mt">
                <img [src]="item.previewUrl" class="preview-img" loading="lazy">
                <app-item-icons [item]="item"></app-item-icons>
              </div>
            </div>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</ng-container>
