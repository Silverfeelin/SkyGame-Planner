"use strict";(self.webpackChunkSkyGame_Planner=self.webpackChunkSkyGame_Planner||[]).push([[471],{4471:(V,v,a)=>{a.r(v),a.d(v,{EditorModule:()=>L});var m=a(6575),h=a(7723),t=a(1699);const x=function(){return["/editor/ts"]},M=function(){return["/editor/tree"]},y=function(){return["/editor/shop"]};let Z=(()=>{class s{static#t=this.\u0275fac=function(n){return new(n||s)};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-editor-dashboard"]],decls:6,vars:6,consts:[[3,"routerLink"]],template:function(n,i){1&n&&(t.TgZ(0,"a",0),t._uU(1,"Create TS"),t.qZA(),t.TgZ(2,"a",0),t._uU(3,"Create Spirit Tree"),t.qZA(),t.TgZ(4,"a",0),t._uU(5,"Create Shop"),t.qZA()),2&n&&(t.Q6J("routerLink",t.DdM(3,x)),t.xp6(2),t.Q6J("routerLink",t.DdM(4,M)),t.xp6(2),t.Q6J("routerLink",t.DdM(5,y)))},dependencies:[h.rH]})}return s})();var J=a(292),S=a.n(J);let l=(s=21)=>crypto.getRandomValues(new Uint8Array(s)).reduce((d,e)=>d+((e&=63)<36?e.toString(36):e<62?(e-26).toString(36).toUpperCase():e>62?"-":"_"),"");var u=a(3311),g=a(8460),f=a(2848);let N=(()=>{class s{constructor(){}travelingSpiritsToJson(e){return this.stringify(e.map(n=>{const i=n.date;return{guid:n.guid,date:{day:i.date(),month:i.month()+1,year:i.year()},spirit:n.spirit.guid,tree:n.tree.guid}}))}spiritTreesToJson(e){return this.stringify(e.map(n=>({guid:n.guid,node:n.node.guid})))}nodesToJson(e){return this.stringify(e.map(n=>({guid:n.guid,item:n.item?.guid,c:n.c,h:n.h,sc:n.sc,sh:n.sh,ac:n.ac,ec:n.ec,nw:n.nw?.guid,n:n.n?.guid,ne:n.ne?.guid})))}itemsToJson(e){return this.stringify(e.map(n=>({guid:n.guid,type:n.type,name:n.name,icon:n.icon,level:n.level})))}stringify(e){return JSON.stringify(e,void 0,2)}static#t=this.\u0275fac=function(n){return new(n||s)};static#e=this.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})}return s})();var p=a(8849),C=a(140);function w(s,d){if(1&s&&(t.TgZ(0,"option",7),t._uU(1),t.qZA()),2&s){const e=d.$implicit;t.Q6J("value",e.guid),t.xp6(1),t.Oqu(e.name)}}function O(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"div",17),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,o=t.oxw();return t.KtG(o.toggleConnection(i,"nw"))}),t._uU(1,"NW"),t.qZA()}if(2&s){const e=t.oxw().$implicit;t.ekj("green",e.nw)}}function b(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"div",18),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,o=t.oxw();return t.KtG(o.toggleConnection(i,"ne"))}),t._uU(1,"NE"),t.qZA()}if(2&s){const e=t.oxw().$implicit;t.ekj("green",e.ne)}}function A(s,d){if(1&s&&(t.ynx(0),t._uU(1),t.BQk()),2&s){const e=t.oxw().$implicit;t.xp6(1),t.hij("(",e.level,")")}}function I(s,d){if(1&s&&(t.TgZ(0,"option",7),t._uU(1),t.TgZ(2,"span"),t.YNc(3,A,2,1,"ng-container",6),t.qZA(),t.TgZ(4,"span"),t._uU(5),t.qZA()()),2&s){const e=d.$implicit;t.Q6J("value",e.guid),t.xp6(1),t.hij(" ",e.name," "),t.xp6(2),t.Q6J("ngIf",e.level),t.xp6(2),t.hij("(",e.guid,")")}}function U(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"div",8),t.YNc(1,O,2,2,"div",9),t.TgZ(2,"div",10),t.NdJ("click",function(){const o=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.toggleConnection(o,"n"))}),t._uU(3,"N"),t.qZA(),t.YNc(4,b,2,2,"div",11),t.TgZ(5,"div")(6,"select",0),t.NdJ("ngModelChange",function(i){const r=t.CHM(e).$implicit;return t.KtG(r.item=i)}),t._UZ(7,"option",12),t.YNc(8,I,6,4,"option",1),t.qZA()(),t.TgZ(9,"div"),t._UZ(10,"mat-icon",13),t.TgZ(11,"input",14),t.NdJ("ngModelChange",function(i){const r=t.CHM(e).$implicit;return t.KtG(r.c=i)}),t.qZA(),t._UZ(12,"mat-icon",15),t.TgZ(13,"input",14),t.NdJ("ngModelChange",function(i){const r=t.CHM(e).$implicit;return t.KtG(r.h=i)}),t.qZA(),t._UZ(14,"mat-icon",16),t.TgZ(15,"input",14),t.NdJ("ngModelChange",function(i){const r=t.CHM(e).$implicit;return t.KtG(r.ac=i)}),t.qZA()()()}if(2&s){const e=d.$implicit,n=d.index,i=t.oxw();t.xp6(1),t.Q6J("ngIf",n%3==1),t.xp6(1),t.ekj("green",e.n),t.xp6(2),t.Q6J("ngIf",n%3==1),t.xp6(2),t.Q6J("ngModel",e.item),t.xp6(2),t.Q6J("ngForOf",i.itemOptions),t.xp6(3),t.Q6J("ngModel",e.c),t.xp6(2),t.Q6J("ngModel",e.h),t.xp6(2),t.Q6J("ngModel",e.ac)}}function q(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"div")(1,"button",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.copyToClipboard("ts"))}),t._uU(2," Copy TS "),t.qZA(),t.TgZ(3,"button",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.copyToClipboard("tree"))}),t._uU(4," Copy Tree "),t.qZA(),t.TgZ(5,"button",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.copyToClipboard("nodes"))}),t._uU(6," Copy Nodes "),t.qZA(),t.TgZ(7,"button",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.copyToClipboard("items"))}),t._uU(8," Copy Items "),t.qZA()()}}let F=(()=>{class s{constructor(e,n){this.dataService=e,this.dataJsonService=n,this.spiritOptions=new Array,this.itemOptions=new Array,this.tsCount=e.travelingSpiritConfig.items.length,this.spiritOptions=e.spiritConfig.items.filter(o=>"Season"===o.type).sort((o,r)=>o.name.localeCompare(r.name));const i=e.travelingSpiritConfig.items.at(-1).date;this.date=i.add(2,"weeks").isoWeekday(4).format("YYYY-MM-DD"),this.formNodes=[];for(let o=0;o<24;o++)this.formNodes.push({n:!((o+2)%3)})}spiritChanged(){this.formNodes.forEach(o=>o.item=void 0),this.itemOptions=[];const e=[...this.dataService.travelingSpiritConfig.items].reverse().find(o=>o.spirit.guid===this.spirit),n=this.dataService.spiritConfig.items.find(o=>o.guid===this.spirit)?.tree;let i=[];e?(i=u.f.all(e.tree.node),this.formNodes=this.nodeToFormNodes(e.tree.node)):n&&(i=u.f.all(n.node).filter(o=>"Season Heart"!==o.item?.name)),this.itemOptions.push({guid:"DON'T PICK",name:"-- SPIRIT ITEMS --",type:g.q.Special}),this.itemOptions.push(...i.filter(o=>o.item).map(o=>o.item)),this.itemOptions.push({guid:"DON'T PICK",name:"-- NEW ITEMS --",type:g.q.Special}),this.itemOptions.push(this.createWingBuff()),this.itemOptions.push(this.createHeart()),this.itemOptions.push(this.createBlessing()),this.itemOptions.push(this.createBlessing()),this.itemOptions.push(this.createBlessing()),this.itemOptions.push(this.createBlessing())}toggleConnection(e,n){e[n]=!e[n]}submit(){const e=this.spiritOptions.find(T=>T.guid==this.spirit),n=this.dataService.travelingSpiritConfig.items.filter(T=>T.spirit.guid===this.spirit).length;if(!e)return void alert("No spirit");const i=this.formNodeToNodes(),o=u.f.all(i),r={guid:l(10),node:o[0]},c=S()(new Date(this.date)),_={guid:l(10),date:c,endDate:c.add(4,"days"),spirit:e,tree:r,number:this.tsCount+1,visit:n+1};console.log("ts generated",_),this.result=_}copyToClipboard(e){let n=this.getForClipboard(e);if(!n)return;const i=n.indexOf("{"),o=n.lastIndexOf("}");n=n.substring(i,o+1)+",",navigator.clipboard.writeText(n)}getForClipboard(e){switch(e){case"ts":return this.dataJsonService.travelingSpiritsToJson([this.result]);case"tree":return this.dataJsonService.spiritTreesToJson([this.result.tree]);case"nodes":return this.dataJsonService.nodesToJson(u.f.all(this.result.tree.node));case"items":{const i=u.f.all(this.result.tree.node).filter(o=>o.item?.guid&&!this.dataService.guidMap.has(o.item.guid)).map(o=>o.item);return this.dataJsonService.itemsToJson(i)}}}nodeToFormNodes(e){const n=new Array;for(let r=0;r<24;r++)n.push({});const i=(r,c)=>{n[r]={item:c.item?.guid,c:c.c,h:c.h,ac:c.ac,n:!!c.n,nw:!!c.nw,ne:!!c.ne},c.nw&&i(r-1,c.nw),c.n&&i(r-3,c.n),c.ne&&i(r+1,c.ne)};return i(22,e),n}formNodeToNodes(e,n=22){const i=this.formNodes[n];if(e??=this.formNodeToNode(i),!i)return e;if(i.nw){const o=n-1,r=this.formNodeToNode(this.formNodes[o]);r&&(e.nw=r),this.formNodeToNodes(r,o)}if(i.n){const o=n-3,r=this.formNodeToNode(this.formNodes[o]);r&&(e.n=r),this.formNodeToNodes(r,o)}if(i.ne){const o=n+1,r=this.formNodeToNode(this.formNodes[o]);r&&(e.ne=r),this.formNodeToNodes(r,o)}return e}formNodeToNode(e){if(e?.item)return{guid:l(10),item:this.itemOptions.find(n=>n.guid===e.item),c:e.c,h:e.h,ac:e.ac}}createHeart(){return{guid:l(10),type:g.q.Special,name:"Heart",icon:"https://static.wikia.nocookie.net/sky-children-of-the-light/images/d/d9/Heart.png"}}createBlessing(){return{guid:l(10),type:g.q.Special,name:"Blessing",icon:"https://static.wikia.nocookie.net/sky-children-of-the-light/images/8/8e/5CandlesSpell.png"}}createWingBuff(){return{guid:l(10),type:g.q.WingBuff,name:"Wing Buff",icon:"https://static.wikia.nocookie.net/sky-children-of-the-light/images/3/31/Winglight.png"}}static#t=this.\u0275fac=function(n){return new(n||s)(t.Y36(f.D),t.Y36(N))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-editor-traveling-spirit"]],decls:17,vars:7,consts:[[1,"mono",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","date",3,"ngModel","ngModelChange"],[1,"grid-container"],["class","grid-item",4,"ngFor","ngForOf"],["type","button",3,"click"],[4,"ngIf"],[3,"value"],[1,"grid-item"],["class","grid-item-connection grid-item-nw",3,"green","click",4,"ngIf"],[1,"grid-item-connection","grid-item-n",3,"click"],["class","grid-item-connection grid-item-ne",3,"green","click",4,"ngIf"],["value",""],["svgIcon","candle"],["type","number",1,"cost",3,"ngModel","ngModelChange"],["svgIcon","heart"],["svgIcon","ascended-candle"],[1,"grid-item-connection","grid-item-nw",3,"click"],[1,"grid-item-connection","grid-item-ne",3,"click"]],template:function(n,i){1&n&&(t.TgZ(0,"div"),t._uU(1),t.qZA(),t.TgZ(2,"div"),t._uU(3," Spirit: "),t.TgZ(4,"select",0),t.NdJ("ngModelChange",function(r){return i.spirit=r})("ngModelChange",function(){return i.spiritChanged()}),t.YNc(5,w,2,2,"option",1),t.qZA()(),t.TgZ(6,"div"),t._uU(7," Date: "),t.TgZ(8,"input",2),t.NdJ("ngModelChange",function(r){return i.date=r}),t.qZA()(),t.TgZ(9,"div"),t._uU(10," Nodes"),t._UZ(11,"br"),t.TgZ(12,"div",3),t.YNc(13,U,16,9,"div",4),t.qZA()(),t.TgZ(14,"button",5),t.NdJ("click",function(){return i.submit()}),t._uU(15,"Generate"),t.qZA(),t.YNc(16,q,9,0,"div",6)),2&n&&(t.xp6(1),t.AsE(" There are currently ",i.tsCount," TS registered. Add #",i.tsCount+1," now.\n"),t.xp6(3),t.Q6J("ngModel",i.spirit),t.xp6(1),t.Q6J("ngForOf",i.spiritOptions),t.xp6(3),t.Q6J("ngModel",i.date),t.xp6(5),t.Q6J("ngForOf",i.formNodes),t.xp6(3),t.Q6J("ngIf",i.result))},dependencies:[m.sg,m.O5,p.YN,p.Kr,p.Fj,p.wV,p.EJ,p.JJ,p.On,C.Hw],styles:[".grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);grid-gap:10px}.grid-item[_ngcontent-%COMP%]{position:relative;background-color:var(--color-background);padding:var(--padding-content);padding-top:25px;text-align:center}.grid-item-connection[_ngcontent-%COMP%]{position:absolute;background:#800;top:0;padding:2px;line-height:16px}.grid-item-connection.green[_ngcontent-%COMP%]{background:#080}.grid-item-nw[_ngcontent-%COMP%]{left:0}.grid-item-n[_ngcontent-%COMP%]{left:50%;transform:translate(-50%)}.grid-item-ne[_ngcontent-%COMP%]{right:0}.cost[_ngcontent-%COMP%]{width:60px}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{display:inline-block;line-height:14px;font-size:14px}"]})}return s})();var H=a(9074),G=a.n(H);function Q(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"div",19),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,o=t.oxw();return t.KtG(o.toggleConnection(i,"nw"))}),t._uU(1,"NW"),t.qZA()}if(2&s){const e=t.oxw().$implicit;t.ekj("green",e.nw)}}function K(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"div",20),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,o=t.oxw();return t.KtG(o.toggleConnection(i,"ne"))}),t._uU(1,"NE"),t.qZA()}if(2&s){const e=t.oxw().$implicit;t.ekj("green",e.ne)}}function P(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"b",21),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,o=t.oxw();return t.KtG(o.copyNodeToClipboard(i))}),t._uU(1),t.qZA()}if(2&s){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.item)}}function j(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"div",4),t.YNc(1,Q,2,2,"div",5),t.TgZ(2,"div",6),t.NdJ("click",function(){const o=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.toggleConnection(o,"n"))}),t._uU(3,"N"),t.qZA(),t.YNc(4,K,2,2,"div",7),t.TgZ(5,"div")(6,"div",8),t._uU(7),t.qZA(),t.TgZ(8,"div",8),t.YNc(9,P,2,1,"b",9),t.qZA(),t.TgZ(10,"input",10),t.NdJ("input",function(i){const r=t.CHM(e).index,c=t.oxw();return t.KtG(c.itemInputChanged(i,r))})("keydown",function(i){const r=t.CHM(e).index,c=t.oxw();return t.KtG(c.itemInputEnter(i,r))}),t.qZA()(),t.TgZ(11,"div",11),t._UZ(12,"mat-icon",12),t.TgZ(13,"input",13),t.NdJ("ngModelChange",function(i){const r=t.CHM(e).$implicit;return t.KtG(r.c=i)}),t.qZA(),t._UZ(14,"mat-icon",14),t.TgZ(15,"input",13),t.NdJ("ngModelChange",function(i){const r=t.CHM(e).$implicit;return t.KtG(r.h=i)}),t.qZA(),t._UZ(16,"mat-icon",15),t.TgZ(17,"input",13),t.NdJ("ngModelChange",function(i){const r=t.CHM(e).$implicit;return t.KtG(r.sc=i)}),t.qZA(),t._UZ(18,"mat-icon",16),t.TgZ(19,"input",13),t.NdJ("ngModelChange",function(i){const r=t.CHM(e).$implicit;return t.KtG(r.sh=i)}),t.qZA(),t._UZ(20,"mat-icon",17),t.TgZ(21,"input",13),t.NdJ("ngModelChange",function(i){const r=t.CHM(e).$implicit;return t.KtG(r.ac=i)}),t.qZA(),t._UZ(22,"mat-icon",18),t.TgZ(23,"input",13),t.NdJ("ngModelChange",function(i){const r=t.CHM(e).$implicit;return t.KtG(r.ec=i)}),t.qZA()()()}if(2&s){const e=d.$implicit,n=d.index;t.xp6(1),t.Q6J("ngIf",n%3==1),t.xp6(1),t.ekj("green",e.n),t.xp6(2),t.Q6J("ngIf",n%3==1),t.xp6(3),t.hij("",(null==e.itemRef?null:e.itemRef.name)||"","\xa0"),t.xp6(2),t.Q6J("ngIf",e.item),t.xp6(4),t.Q6J("ngModel",e.c),t.xp6(2),t.Q6J("ngModel",e.h),t.xp6(2),t.Q6J("ngModel",e.sc),t.xp6(2),t.Q6J("ngModel",e.sh),t.xp6(2),t.Q6J("ngModel",e.ac),t.xp6(1),t.Q6J("inline",!1),t.xp6(1),t.Q6J("ngModel",e.ec)}}function $(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"div")(1,"button",2),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.copyToClipboard("tree"))}),t._uU(2," Copy Tree "),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.copyToClipboard("nodes"))}),t._uU(4," Copy Nodes "),t.qZA(),t.TgZ(5,"button",2),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.copyToClipboard("items"))}),t._uU(6," Copy Items "),t.qZA()()}}function B(s,d){if(1&s){const e=t.EpF();t.TgZ(0,"div")(1,"button",2),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.copyToClipboard("shop"))}),t._uU(2," Copy Shop "),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.copyToClipboard("iaps"))}),t._uU(4," Copy IAPs "),t.qZA()()}}function W(s,d){if(1&s&&(t.TgZ(0,"option"),t._uU(1),t.qZA()),2&s){const e=d.$implicit;t.xp6(1),t.Oqu(e)}}const R=[{path:"",component:Z},{path:"ts",component:F},{path:"tree",component:(()=>{class s{constructor(e,n,i){this._dataService=e,this._dataJsonService=n,this._route=i,this.itemOptions=new Array,this.formNodes=[];for(let o=0;o<30;o++)this.formNodes.push({n:!((o+2)%3)})}ngOnInit(){this.formNodes.forEach(n=>n.item=void 0);const e=this._route.snapshot.queryParams.copy;if(e){const n=this._dataService.guidMap.get(e);this.formNodes=this.nodeToFormNodes(n.node)}this.itemOptions=[],this.itemOptions.push(...this._dataService.itemConfig.items),this.itemOptions.push({guid:"DON'T PICK",name:"-- NEW ITEMS --",type:g.q.Special}),this.itemOptions.push(this.createWingBuff()),this.itemOptions.push(this.createHeart()),this.itemOptions.push(this.createBlessing()),this.itemOptions.push(this.createBlessing()),this.itemOptions.push(this.createBlessing()),this.itemOptions.push(this.createBlessing())}toggleConnection(e,n){e[n]=!e[n]}itemInputChanged(e,n){const i=e.target,o=i?.value;if(!o)return;const r=this.getNodeFromJson(o);if(r)return void(this.formNodes[n]=r);const c=this._dataService.guidMap.get(o);c&&(this.formNodes[n].item=c.guid,this.formNodes[n].itemRef=c,i.value="",i.blur())}itemInputEnter(e,n){if("Enter"!==e.key)return;const i=e.target,o=i?.value;if(!o)return;const c=G().go(o,this.itemOptions,{key:"name",limit:1})?.[0].obj;c&&(this.formNodes[n].item=c.guid,this.formNodes[n].itemRef=c,i.value="")}submit(){const e=this.formNodeToNodes(),n=u.f.all(e),i={guid:l(10),node:n[0]};console.log("tree generated",i),this.result=i}copyToClipboard(e){let n=this.getForClipboard(e);if(!n)return;const i=n.indexOf("{"),o=n.lastIndexOf("}");n=n.substring(i,o+1)+",",navigator.clipboard.writeText(n)}getForClipboard(e){switch(e){case"tree":return this._dataJsonService.spiritTreesToJson([this.result]);case"nodes":return this._dataJsonService.nodesToJson(u.f.all(this.result.node));case"items":{const i=u.f.all(this.result.node).filter(o=>o.item?.guid&&!this._dataService.guidMap.has(o.item.guid)).map(o=>o.item);return this._dataJsonService.itemsToJson(i)}}}nodeToFormNodes(e){const n=new Array;for(let r=0;r<30;r++)n.push({});const i=(r,c)=>{n[r]={item:c.item?.guid,itemRef:c.item,c:c.c,h:c.h,ac:c.ac,ec:c.ec,sc:c.sc,sh:c.sh,n:!!c.n,nw:!!c.nw,ne:!!c.ne},c.nw&&i(r-1,c.nw),c.n&&i(r-3,c.n),c.ne&&i(r+1,c.ne)};return i(28,e),n}copyNodeToClipboard(e){const n={...e};delete n.itemRef,navigator.clipboard.writeText(JSON.stringify(n))}getNodeFromJson(e){try{const n=JSON.parse(e);return n.item&&(n.itemRef=this._dataService.guidMap.get(n.item)),n}catch{return}}formNodeToNodes(e,n=28){const i=this.formNodes[n];if(e??=this.formNodeToNode(i),!i)return e;if(i.nw){const o=n-1,r=this.formNodeToNode(this.formNodes[o]);r&&(e.nw=r),this.formNodeToNodes(r,o)}if(i.n){const o=n-3,r=this.formNodeToNode(this.formNodes[o]);r&&(e.n=r),this.formNodeToNodes(r,o)}if(i.ne){const o=n+1,r=this.formNodeToNode(this.formNodes[o]);r&&(e.ne=r),this.formNodeToNodes(r,o)}return e}formNodeToNode(e){if(e?.item)return{guid:l(10),item:this.itemOptions.find(n=>n.guid===e.item),c:e.c,h:e.h,ac:e.ac,ec:e.ec,sc:e.sc,sh:e.sh}}createHeart(){return{guid:l(10),type:g.q.Special,name:"Heart",icon:"https://static.wikia.nocookie.net/sky-children-of-the-light/images/d/d9/Heart.png"}}createBlessing(){return{guid:l(10),type:g.q.Special,name:"Blessing",icon:"https://static.wikia.nocookie.net/sky-children-of-the-light/images/8/8e/5CandlesSpell.png"}}createWingBuff(){return{guid:l(10),type:g.q.WingBuff,name:"Wing Buff",icon:"https://static.wikia.nocookie.net/sky-children-of-the-light/images/3/31/Winglight.png"}}static#t=this.\u0275fac=function(n){return new(n||s)(t.Y36(f.D),t.Y36(N),t.Y36(h.gz))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-editor-tree-spirit"]],decls:8,vars:2,consts:[[1,"grid-container"],["class","grid-item",4,"ngFor","ngForOf"],["type","button",3,"click"],[4,"ngIf"],[1,"grid-item"],["class","grid-item-connection grid-item-nw",3,"green","click",4,"ngIf"],[1,"grid-item-connection","grid-item-n",3,"click"],["class","grid-item-connection grid-item-ne",3,"green","click",4,"ngIf"],[1,"d-inline-block"],[3,"click",4,"ngIf"],[3,"input","keydown"],[1,"mt-1"],["svgIcon","candle"],["type","number",1,"cost",3,"ngModel","ngModelChange"],["svgIcon","heart"],["svgIcon","candle",1,"seasonal"],["svgIcon","heart",1,"seasonal"],["svgIcon","ascended-candle"],["svgIcon","ticket",3,"inline"],[1,"grid-item-connection","grid-item-nw",3,"click"],[1,"grid-item-connection","grid-item-ne",3,"click"],[3,"click"]],template:function(n,i){1&n&&(t.TgZ(0,"div"),t._uU(1," Nodes"),t._UZ(2,"br"),t.TgZ(3,"div",0),t.YNc(4,j,24,13,"div",1),t.qZA()(),t.TgZ(5,"button",2),t.NdJ("click",function(){return i.submit()}),t._uU(6,"Generate"),t.qZA(),t.YNc(7,$,7,0,"div",3)),2&n&&(t.xp6(4),t.Q6J("ngForOf",i.formNodes),t.xp6(3),t.Q6J("ngIf",i.result))},dependencies:[m.sg,m.O5,p.Fj,p.wV,p.JJ,p.On,C.Hw],styles:[".grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);grid-gap:10px}.grid-item[_ngcontent-%COMP%]{position:relative;background-color:var(--color-background);padding:var(--padding-content);padding-top:25px;text-align:center}.grid-item-connection[_ngcontent-%COMP%]{position:absolute;background:#800;top:0;padding:2px;line-height:16px}.grid-item-connection.green[_ngcontent-%COMP%]{background:#080}.grid-item-nw[_ngcontent-%COMP%]{left:0}.grid-item-n[_ngcontent-%COMP%]{left:50%;transform:translate(-50%)}.grid-item-ne[_ngcontent-%COMP%]{right:0}.cost[_ngcontent-%COMP%]{width:60px}input[_ngcontent-%COMP%]{display:inline-block;line-height:14px;font-size:14px}"]})}return s})()},{path:"shop",component:(()=>{class s{constructor(e){this._dataService=e,this.returning=!0}shopGuidChanged(){if(!this.copyShopGuid)return;const e=this._dataService.guidMap.get(this.copyShopGuid);e&&(this.copyShop=e)}submit(){if(!this.copyShop)return;const e=[];this.copyShop.iaps?.forEach(i=>{e.push({guid:l(10),name:i.name,price:i.price,returning:this.returning||void 0,c:i.c,sc:i.sc,sp:i.sp,items:i.items?[...i.items.map(o=>o.guid)]:void 0})});const n={guid:l(10),type:this.copyShop.type,spirit:this.copyShop.spirit?.guid||void 0,iaps:e.map(i=>i.guid)};this.result={shop:n,iaps:e}}copyToClipboard(e){let n=this.getForClipboard(e);if(!n)return;let i=JSON.stringify(n,void 0,2);const o=i.indexOf("{"),r=i.lastIndexOf("}");i=i.substring(o,r+1)+",",navigator.clipboard.writeText(i)}getForClipboard(e){switch(e){case"shop":return[this.result.shop];case"iaps":return this.result.iaps;default:return[]}}static#t=this.\u0275fac=function(n){return new(n||s)(t.Y36(f.D))};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-editor-shop"]],decls:9,vars:3,consts:[["type","text",3,"ngModel","ngModelChange"],["type","checkbox",3,"ngModel","ngModelChange"],["type","button",3,"click"],[4,"ngIf"]],template:function(n,i){1&n&&(t.TgZ(0,"div"),t._uU(1," Shop to copy: "),t.TgZ(2,"input",0),t.NdJ("ngModelChange",function(r){return i.copyShopGuid=r})("ngModelChange",function(){return i.shopGuidChanged()}),t.qZA(),t._UZ(3,"br"),t._uU(4," Returning IAPs: "),t.TgZ(5,"input",1),t.NdJ("ngModelChange",function(r){return i.returning=r}),t.qZA(),t.TgZ(6,"button",2),t.NdJ("click",function(){return i.submit()}),t._uU(7,"Submit"),t.qZA()(),t.YNc(8,B,5,0,"div",3)),2&n&&(t.xp6(2),t.Q6J("ngModel",i.copyShopGuid),t.xp6(3),t.Q6J("ngModel",i.returning),t.xp6(3),t.Q6J("ngIf",i.result))},dependencies:[m.O5,p.Fj,p.Wl,p.JJ,p.On]})}return s})()},{path:"item",component:(()=>{class s{constructor(){this.name="",this.type="",this.icon="",this.typeOptions=["","Hat","Hair","Mask","FaceAccessory","Necklace","Outfit","Shoes","Cape","Instrument","Held","Prop","Emote","Stance","Call","Spell","Music","Quest","WingBuff","Special"]}generate(){let e=this.icon;const n=e.indexOf("/revision");n>=0&&(e=e.substring(0,n));const i={guid:l(10),name:this.name,type:this.type,icon:e};let o=JSON.stringify(i,null,2);navigator.clipboard.writeText(o+",")}static#t=this.\u0275fac=function(n){return new(n||s)};static#e=this.\u0275cmp=t.Xpm({type:s,selectors:[["app-editor-item"]],decls:9,vars:4,consts:[["type","text","placeholder","Name",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-control",3,"ngModel","ngModelChange"],[4,"ngFor","ngForOf"],["type","text","placeholder","Icon",1,"form-control",3,"ngModel","ngModelChange"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(n,i){1&n&&(t._uU(0,"Name\n"),t.TgZ(1,"input",0),t.NdJ("ngModelChange",function(r){return i.name=r}),t.qZA(),t._uU(2,"\nType\n"),t.TgZ(3,"select",1),t.NdJ("ngModelChange",function(r){return i.type=r}),t.YNc(4,W,2,1,"option",2),t.qZA(),t._uU(5,"\nIcon\n"),t.TgZ(6,"input",3),t.NdJ("ngModelChange",function(r){return i.icon=r}),t.qZA(),t.TgZ(7,"button",4),t.NdJ("click",function(){return i.generate()}),t._uU(8,"Generate"),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngModel",i.name),t.xp6(2),t.Q6J("ngModel",i.type),t.xp6(1),t.Q6J("ngForOf",i.typeOptions),t.xp6(2),t.Q6J("ngModel",i.icon))},dependencies:[m.sg,p.YN,p.Kr,p.Fj,p.EJ,p.JJ,p.On]})}return s})()}];let z=(()=>{class s{static#t=this.\u0275fac=function(n){return new(n||s)};static#e=this.\u0275mod=t.oAB({type:s});static#n=this.\u0275inj=t.cJS({imports:[h.Bz.forChild(R),h.Bz]})}return s})(),L=(()=>{class s{static#t=this.\u0275fac=function(n){return new(n||s)};static#e=this.\u0275mod=t.oAB({type:s});static#n=this.\u0275inj=t.cJS({imports:[m.ez,p.u5,C.Ps,z]})}return s})()}}]);
//# sourceMappingURL=471.5989f90acf7be6b9.js.map